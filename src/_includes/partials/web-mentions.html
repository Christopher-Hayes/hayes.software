<!-- Filter the cached mentions to only include ones matching the post's url -->
{% set mentions = webmentions | getWebmentionsForUrl(metadata.url +
webmentionUrl) %}
<!-- Set reposts as mentions that are `repost-of`  -->
{% set reposts = mentions | webmentionsByType('repost-of') %}
<!-- Count the total reposts -->
{% set repostsSize = reposts | size %}
<!-- Set likes as mentions that are `like-of`  -->
{% set likes = mentions | webmentionsByType('like-of') %}
<!-- Count the total likes -->
{% set likesSize = likes | size %}
<!-- Set replies as mentions that are `in-reply-to`  -->
{% set replies = mentions | webmentionsByType('in-reply-to') %}
<!-- Count the total replies -->
{% set repliesSize = replies | size %}

<!-- _includes/webmentions.njk --><!-- ...setting variables and other markup -->{%
if repliesSize > 0 %}
<div class="webmention-replies">
  <h3>
    {{ repliesSize }} {% if repliesSize == "1" %}Reply{% else %}Replies{% endif
    %}
  </h3>
  {% for webmention in replies %} {% include 'webmention.njk' %} {% endfor %}
</div>
{% endif %} Finally, we can render our replies using that new partial for a
single reply webmention. Here, if the author has a photo, we show it, otherwise
we show an avatar. We also conditionally show their name if it exists, otherwise
we show "Anonymous". We use our readableDateFromISO filter to show a
human-friendly published date, and finally render the text of the webmention:

<!-- _includes/webmention.njk -->
<article class="webmention" id="webmention-{{ webmention['wm-id'] }}">
  <div class="webmention__meta">
    {% if webmention.author %} {% if webmention.author.photo %}
    <img
      src="{{ webmention.author.photo }}"
      alt="{{ webmention.author.name }}"
      width="48"
      height="48"
      loading="lazy"
    />
    {% else %}
    <img src="{{ '/img/avatar.svg' | url }}" alt="" width="48" height="48" /> {%
    endif %}
    <span>
      <a
        class="h-card u-url"
        {%
        if
        webmention.url
        %}href="{{ webmention.url }}"
        {%
        endif
        %}
        target="_blank"
        rel="noopener noreferrer"
        ><strong class="p-name">{{ webmention.author.name }}</strong></a
      >
    </span>
    {% else %} <span> <strong>Anonymous</strong> </span> {% endif %} {% if
    webmention.published %}
    <time class="postlist-date" datetime="{{ webmention.published }}">
      {{ webmention.published | readableDateFromISO }}
    </time>
    {% endif %}
  </div>
  <div>{{ webmention.content.text }}</div>
</article>
